<div id="certificate"  class="page-layout simple"  style="overflow: auto; height: 100%; background-color: #f7f7f7;">
    <div class="content">   
        <mat-card class="mat-elevation-z0"  style="width: 90%; margin: 20px auto 10px auto;">
            
            <div fxLayout="column" fxLayoutAlign="space-evenly none">
                <form name="resultForm" class="product w-100-p" fxLayout="column" fxFlex>
                <div fxLayout="row" fxLayoutAlign="space-between center">

                    <mat-form-field appearance="outline" style="font-size: 12px;" fxFlex fxFlex="20">
                        <mat-label>Contract Number</mat-label>
                        <input matInput 
                        #filter 
                        [(ngModel)]="this.dataFilter.contract"
                        name="contract_number"
                        placeholder="Contract Number">
                    </mat-form-field>

                    <ng-select 
                    appearance="outline"
                    appendTo="body" 
                    bindLabel="name" 
                    bindValue="id" 
                    name="hold"
                    [(ngModel)]="this.dataFilter.hold"
                    [items]="holds"
                    fxFlex="10" fxHide fxShow.gt-xs
                    [clearable]="false"
                    placeholder="Status Hold" 
                    dropdownPosition="bottom" 
                    style="display: flex; justify-content: center; align-items: center;">
                        <ng-template ng-option-tmp let-item="item" let-index="index">
                            {{item.name}}
                        </ng-template>
                        <ng-template ng-label-tmp let-item="item">
                            {{item.name}}
                        </ng-template>
                    </ng-select> 

                    <ng-select 
                    appearance="outline"
                    appendTo="body"  
                    bindLabel="customer_name" 
                    bindValue="id_customer"                     
                    fxFlex="40" fxHide fxShow.gt-xs
                    [clearable]="false"                     
                    [items]="dataCustomer"
                    placeholder="Select Customer" 
                    name="customer"
                    [(ngModel)]="this.dataFilter.customer"
                    (search)="onsearchselect($event,'customer')"
                    (scrollToEnd)="onScrollToEnd('customer')"
                    dropdownPosition="bottom" 
                    style="display: flex; justify-content: center; align-items: center;">
                        <ng-template ng-option-tmp let-item="item" let-index="index">
                            {{item.customer_name}}
                        </ng-template>
                        <ng-template ng-label-tmp let-item="item">
                            {{item.customer_name}}
                        </ng-template>
                    </ng-select> 
                    
                    <ng-select 
                    appearance="outline"
                    appendTo="body" 
                    bindLabel="name" 
                    bindValue="id" 
                    name="status"
                    [(ngModel)]="this.dataFilter.status"
                    fxFlex="10" fxHide fxShow.gt-xs
                    [clearable]="false"
                    placeholder="Status" 
                    [items]="DataStatus"
                    dropdownPosition="bottom" 
                    style="display: flex; justify-content: center; align-items: center;">
                        <ng-template ng-option-tmp let-item="item" let-index="index">
                            {{item.name}}
                        </ng-template>
                        <ng-template ng-label-tmp let-item="item">
                            {{item.name}}
                        </ng-template>
                    </ng-select> 

                    <ng-select 
                    appearance="outline"
                    appendTo="body"  
                    bindLabel="group_name" 
                    bindValue="id"                     
                    fxFlex="19" fxHide fxShow.gt-xs
                    [clearable]="false" 
                    [items]="groupdata"
                    placeholder="Select Team" 
                    name="team"
                    [(ngModel)]="this.dataFilter.team"
                    dropdownPosition="bottom" 
                    style="display: flex; justify-content: center; align-items: center;">
                        <ng-template ng-option-tmp let-item="item" let-index="index">
                            {{item.group_name}}
                        </ng-template>
                        <ng-template ng-label-tmp let-item="item">
                            {{item.group_name}}
                        </ng-template>
                    </ng-select>                                            
                </div>

                <div fxLayout="row" fxLayoutAlign="end center">
                    <button mat-raised-button 
                    color="primary"  
                    fxFlex="15"  fxFlex.xs="15" 
                    style="height: 40px; width:250px; margin-right:15px;"
                    (click)="searchData()">
                        Search
                    </button>
                    <button mat-stroked-button color="primary" fxFlex="15" fxFlex.xs="15" style="height: 40px;" (click)="resetData()">
                        Reset
                    </button>
                </div>
               </form>

            </div>
    </mat-card>
    <mat-card class="mat-elevation-z0" style="width: 90%; margin: 20px auto 10px auto;">        
        <mat-progress-bar
            color="primary"
            mode="indeterminate"
            value="50" *ngIf="load">
        </mat-progress-bar>
        <div fxLayout="row" fxLayoutAlign="space-between center" >
            <div style="margin-bottom:40px;">
                <span style="font-size: 18px; font-weight: bolder; color: #303030; margin-right: 25px;" fxHide fxShow.gt-md>Admin Certificate </span>
            </div>
           <div style="margin-bottom:40px;" fxLayout="row" fxLayoutAlign="space-evenly center" >
                <!-- button -->
                <!-- <button mat-icon-button 
                [routerLink]="'/analystpro/admin-certificate/list-akg/admin-panel'"
                matTooltip="Nutrition Facts">
                    <mat-icon>receipt</mat-icon>
                </button> -->

                <button mat-icon-button 
                (click)="reportDialog()"
                matTooltip="Report Dialogue">
                    <mat-icon>open_in_new</mat-icon>
                </button>

                <button mat-icon-button 
                (click)="goToAutoDraft()"
                matTooltip="Preparation Auto Release">
                    <mat-icon>assignment</mat-icon>
                </button>
           </div>
        </div>
         <!-- / SEARCH FILTER -->
        <mat-table class="cert-table" #table [dataSource]="certData" matSort (matSortChange)="sortData($event)"
        [@animateStagger]="{value:'50'}" fusePerfectScrollbar *ngIf="this.certData.length > 0">
    
        <!-- Column -->
        <ng-container matColumnDef="contract_no">
            <mat-header-cell *matHeaderCellDef mat-sort-header="contract_no">Contract</mat-header-cell>
            <mat-cell *matCellDef="let certData">
                <span class="text-truncate" 
                matTooltip="{{certData.contract_category.title}}" 
                style="margin-top: 5px;">
                    {{ certData.contract_no }}
                </span>
            </mat-cell>
        </ng-container>

         <!-- Column -->
         <ng-container matColumnDef="hold">
            <mat-header-cell *matHeaderCellDef mat-sort-header="hold">Hold</mat-header-cell>
            <mat-cell *matCellDef="let certData">
                <div>
                    <span class="text-truncate"
                    style="color: #911F27;" 
                    matTooltip="hold" 
                    *ngIf="certData.hold == 'Y'">
                        <mat-icon style="font-size: 20px;">lock</mat-icon>
                    </span>
                    <span class="text-truncate"
                    style="color: #3DB2FF;" 
                    matTooltip="unhold" 
                    *ngIf="certData.hold == 'N'">
                        <mat-icon style="font-size: 20px;">lock_open</mat-icon>
                    </span>
                </div>
            </mat-cell>
        </ng-container>

        <!-- Column -->
        <ng-container matColumnDef="customer_name">
            <mat-header-cell *matHeaderCellDef mat-sort-header="customer_name">Customer Name</mat-header-cell>
            <mat-cell *matCellDef="let certData">
            <div fxLayout="column">
                    <span class="text-truncate" matTooltip="{{certData.customers_handle.customers.customer_name}}">{{certData.customers_handle.customers.customer_name}}</span>
                    <span class="text-truncate" matTooltip="{{certData.customers_handle.contact_person.name}}"
                        style="color: f5f5f5; font-size: 10px;">{{certData.customers_handle.contact_person.name}}</span>
                    </div>
            </mat-cell>
        </ng-container>


        <!-- Column -->
        <ng-container matColumnDef="progress">
            <mat-header-cell *matHeaderCellDef mat-sort-header="progress">LHU / Sample</mat-header-cell>
            <mat-cell *matCellDef="let certData">
                <div class="box-custom">
                    <p class="text-truncate " matTooltip="{{certData.condition_contract_cert.length}} / {{certData.count_samplelab.length}}">
                        {{certData.condition_contract_cert.length}} / {{certData.count_samplelab.length}}
                    </p>
                </div>
            </mat-cell>
        </ng-container>

        <!-- Column -->
        <ng-container matColumnDef="desc">
            <mat-header-cell *matHeaderCellDef mat-sort-header="desc">Desc</mat-header-cell> 
            <mat-cell *matCellDef="let certData">
                <p class="text-truncate" matTooltip="{{certData.desc}}">{{certData.desc}}</p>
            </mat-cell>
        </ng-container>

        <!-- Column -->
        <ng-container matColumnDef="team">
            <mat-header-cell *matHeaderCellDef mat-sort-header="team">Team</mat-header-cell>
            <mat-cell *matCellDef="let certData">
                <p class="text-truncate" matTooltip="{{certData.condition_contract_cert[0].team.group_name}}">{{certData.condition_contract_cert[0].team.group_name}}</p>
            </mat-cell>
        </ng-container>
        
        <mat-header-row *matHeaderRowDef="displayedColumns; sticky:true"></mat-header-row>
        <mat-row *matRowDef="let certData; columns: displayedColumns;" 
        (click)="goDetails(certData.id_kontrakuji)"
        class="standart"
        matRipple>

        </mat-row>
    </mat-table>
    <div fxLayout="row" fxLayoutAlign="end center">
        <mat-paginator #paginator
        [length]="total"
        [pageIndex]="from"
        [pageSize]="to"
        [hidePageSize]="true"
        [showFirstLastButtons]="true"
        (page) = "paginated($event)"
        style="font-size: 10px;"
        *ngIf="this.total > 0">

        </mat-paginator>
    </div>

    <div *ngIf="loadingfirst && this.certData.length === 0" style="width: 20%; margin-left: auto; margin-right: auto; margin-top: auto; margin-bottom: auto; display: block; text-align: center;">
        <img  src="assets/images/gif/loading.gif" />
        <small>Please Wait ...</small>
    </div>

    <div *ngIf="!loadingfirst && this.certData.length === 0" style="width: 20%; margin-left: auto; margin-right: auto; margin-top: auto; margin-bottom: auto; display: block; text-align: center;">
        <img  src="assets/images/gif/selectfile.gif" />
        <small>No Data</small>
    </div>
    </mat-card>
    </div>
</div>