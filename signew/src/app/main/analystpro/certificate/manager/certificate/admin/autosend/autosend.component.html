<div id="autosend"  class="page-layout simple"  style="overflow: auto; height: 100%; background-color: #f7f7f7;">
    <div class="content">   
        <mat-card class="mat-elevation-z0"  style="width: 90%; margin: 20px auto 10px auto;">
            <div fxLayout="column" fxLayoutAlign="space-evenly none">
                <form name="resultForm" class="product w-100-p" fxLayout="column" fxFlex>
                <div fxLayout="row" fxLayoutAlign="space-between center">

                    <mat-form-field appearance="outline" style="font-size: 12px;" fxFlex fxFlex="20">
                        <mat-label>Contract Number</mat-label>
                        <input matInput 
                        #filter 
                        [(ngModel)]="this.dataFilter.contract"
                        name="contract"
                        placeholder="Contract Number">
                    </mat-form-field>

                    <ng-select 
                    appearance="outline"
                    appendTo="body"  
                    bindLabel="customer_name" 
                    bindValue="id_customer"                     
                    fxFlex="40" fxHide fxShow.gt-xs
                    [clearable]="false"                     
                    [items]="dataCustomer"
                    [(ngModel)]="this.dataFilter.customer"
                    placeholder="Select Customer" 
                    name="customer"
                    (search)="onsearchselect($event,'customer')"
                    (scrollToEnd)="onScrollToEnd('customer')"
                    dropdownPosition="bottom" 
                    style="display: flex; justify-content: center; align-items: center;">
                        <ng-template ng-option-tmp let-item="item" let-index="index">
                            {{item.customer_name}}
                        </ng-template>
                        <ng-template ng-label-tmp let-item="item">
                            {{item.customer_name}}
                        </ng-template>
                    </ng-select> 
                    
                    <ng-select 
                    appearance="outline"
                    appendTo="body" 
                    bindLabel="name" 
                    bindValue="id" 
                    [items]="status"
                    name="status"
                    fxFlex="10" fxHide fxShow.gt-xs
                    [clearable]="false"
                    placeholder="Status" 
                    dropdownPosition="bottom" 
                    [(ngModel)]="this.dataFilter.status"
                    style="display: flex; justify-content: center; align-items: center;">
                        <ng-template ng-option-tmp let-item="item" let-index="index">
                            {{item.name}}
                        </ng-template>
                        <ng-template ng-label-tmp let-item="item">
                            {{item.name}}
                        </ng-template>
                    </ng-select> 

                    <mat-form-field appearance="outline" style="font-size: 12px;" fxFlex="29" fxHide fxShow.gt-xs>
                        <mat-label>Date</mat-label>
                        <input matInput [matDatepicker]="picker"  [(ngModel)]="dataFilter.date" name="date">
                        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                        <mat-datepicker #picker></mat-datepicker>
                    </mat-form-field>
                </div>

                <div fxLayout="row" fxLayoutAlign="end center">
                    <button mat-raised-button 
                    color="primary"  
                    fxFlex="15"  fxFlex.xs="15" 
                    (click)="search()"
                    style="height: 40px; width:250px; margin-right:15px;">
                        Search
                    </button>
                    <button mat-stroked-button
                    color="primary" fxFlex="15" fxFlex.xs="15" 
                    (click)="cancelSearch()"
                    style="height: 40px;">
                        Reset
                    </button>
                </div>
               </form>

            </div>
    </mat-card>
    <mat-card class="mat-elevation-z0" style="width: 90%; margin: 20px auto 10px auto;">
        <div fxLayout="row" fxLayoutAlign="space-between center" >
            <div style="margin-bottom:40px;">
                <span style="font-size: 18px; font-weight: bolder; color: #303030; margin-right: 25px;" fxHide fxShow.gt-md>Preparation Auto Release </span>
            </div>
           <div style="margin-bottom:40px;" fxLayout="row" fxLayoutAlign="space-evenly center" >
            <button mat-icon-button color="white" *ngIf="this.checkList.length > 0"
                class="contract-certficate"
                matTooltip="cancel action"
                (click)="cancelAction()"
                [@animate]="{value:'*',params:{delay:'150ms',scale:'0.2'}}"
                style="margin-left: -2px;">
                    <mat-icon>highlight_off</mat-icon>
            </button>
            <button mat-icon-button color="white" *ngIf="this.checkList.length > 0"
                class="contract-certficate"                
                (click)="removeBulk()"
                matTooltip="cancel draft"
                [@animate]="{value:'*',params:{delay:'150ms',scale:'0.2'}}"
                style="margin-left: -2px;">
                    <mat-icon>delete</mat-icon>
            </button>
           </div>
        </div>
         <!-- / SEARCH FILTER -->
        <mat-table class="cert-table" #table [dataSource]="certData" matSort (matSortChange)="sortData($event)"
        [@animateStagger]="{value:'50'}" fusePerfectScrollbar *ngIf="this.certData.length > 0">
        
         <!-- Column -->
         <ng-container matColumnDef="checkbox">
            <mat-header-cell *matHeaderCellDef mat-sort-header="checkbox">
                <!-- <mat-checkbox class="example-margin" 
                (change)="setAll($event.checked)"
                (change)="someComplete()"
                ></mat-checkbox> -->
                
            </mat-header-cell>
            <mat-cell *matCellDef="let certData">
                <mat-checkbox class="example-margin"
                disabled
                [disabled]=" certData.status != 0 ? true : false"
                (ngModelChange)="updateAllComplete()"
                (change)="checkBox($event.checked, certData.id)"
                ></mat-checkbox>
            </mat-cell>
        </ng-container>

        <!-- Column -->
        <ng-container matColumnDef="contract_number">
            <mat-header-cell *matHeaderCellDef mat-sort-header="contract_number">Contract</mat-header-cell>
            <mat-cell *matCellDef="let certData">
                <span class="text-truncate" 
                matTooltip="{{ certData.contract.contract_no }}" 
                style="margin-top: 5px;">
                    {{ certData.contract.contract_no }}
                </span>
            </mat-cell>
        </ng-container>

         <!-- Column -->
         <ng-container matColumnDef="lhu_number">
            <mat-header-cell *matHeaderCellDef mat-sort-header="lhu_number">LHU</mat-header-cell>
            <mat-cell *matCellDef="let certData">
                <span class="text-truncate" 
                matTooltip="{{ certData.certificate.lhu_number }}" 
                style="margin-top: 5px;">
                    {{ certData.certificate.lhu_number }}
                </span>
            </mat-cell>
        </ng-container>

        <!-- Column -->
        <ng-container matColumnDef="customer_name">
            <mat-header-cell *matHeaderCellDef mat-sort-header="customer_name">Customer Name</mat-header-cell>
            <mat-cell *matCellDef="let certData">
            <div fxLayout="column">
                    <span class="text-truncate" matTooltip="{{ certData.contract.customers_handle.customers.customer_name }}">{{ certData.contract.customers_handle.customers.customer_name }}</span>
                    <span class="text-truncate" matTooltip="{{ certData.contract.customers_handle.contact_person.name}}"
                        style="color: f5f5f5; font-size: 10px;">{{ certData.contract.customers_handle.contact_person.name }}</span>
                    </div>
            </mat-cell>
        </ng-container>

         <!-- Column -->
         <ng-container matColumnDef="status">
            <mat-header-cell *matHeaderCellDef mat-sort-header>Status</mat-header-cell>
            <mat-cell *matCellDef="let certData">
                <div class="box-custom" *ngIf="certData.status == 0">
                    <p class="text-truncate" matTooltip="ready">ready</p>
                </div>
                <div class="box-normal" *ngIf="certData.status == 1">
                    <p class="text-truncate" matTooltip="success">success</p>
                </div>
                <div class="box-very-urgent" *ngIf="certData.status == 2">
                    <p class="text-truncate" matTooltip="cancel">cancel</p>
                </div>
                <div class="box-very-urgent" *ngIf="certData.status == 3">
                    <p class="text-truncate" matTooltip="unsuccess">unsuccess</p>
                </div>
            </mat-cell>
        </ng-container>


        <!-- Column -->
        <ng-container matColumnDef="desc">
            <mat-header-cell *matHeaderCellDef mat-sort-header="desc">Desc</mat-header-cell> 
            <mat-cell *matCellDef="let certData">
                <p class="text-truncate" matTooltip="{{certData.certificate.print_info}}">{{certData.certificate.print_info}}</p>
            </mat-cell>
        </ng-container>

        <!-- Column -->
        <ng-container matColumnDef="team">
            <mat-header-cell *matHeaderCellDef mat-sort-header="team">Team</mat-header-cell>
            <mat-cell *matCellDef="let certData">
                <p class="text-truncate" matTooltip="{{ certData.certificate.condition_cert[0].team.group_name }}">{{ certData.certificate.condition_cert[0].team.group_name }}</p>
            </mat-cell>
        </ng-container>
        
        <mat-header-row *matHeaderRowDef="displayedColumns; sticky:true"></mat-header-row>
        <mat-row *matRowDef="let certData; columns: displayedColumns;" 
        class="standart"
        matRipple>

        </mat-row>
    </mat-table>
    <div fxLayout="row" fxLayoutAlign="end center">
        <mat-paginator #paginator
        [length]="total"
        [pageIndex]="from"
        [pageSize]="to"
        [hidePageSize]="true"
        [showFirstLastButtons]="true"
        (page) = "paginated($event)"
        style="font-size: 10px;"
        *ngIf="this.total > 0">

        </mat-paginator>
    </div>

    <div *ngIf="loadingfirst && this.certData.length === 0" style="width: 20%; margin-left: auto; margin-right: auto; margin-top: auto; margin-bottom: auto; display: block; text-align: center;">
        <img  src="assets/images/gif/loading.gif" />
        <small>Please Wait ...</small>
    </div>

    <div *ngIf="!loadingfirst && this.certData.length === 0" style="width: 20%; margin-left: auto; margin-right: auto; margin-top: auto; margin-bottom: auto; display: block; text-align: center;">
        <img  src="assets/images/gif/selectfile.gif" />
        <small>No Data</small>
    </div>
    </mat-card>
    </div>
</div>