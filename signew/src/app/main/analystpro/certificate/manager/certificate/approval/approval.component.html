<div id="approval-certificate" class="page-layout carded fullwidth inner-scroll">

    <!-- TOP BACKGROUND -->
    <div class="top-bg primary-700"></div>
    <!-- / TOP BACKGROUND -->

   <!-- CENTER -->
   <div class="center">

      <!-- HEADER -->
      <div class="header primary-700"
      fxLayout="column" fxLayoutAlign="center center"
      fxLayout.gt-sm="row" fxLayoutAlign.gt-sm="space-between center">

      <!-- APP TITLE -->
      <div class="logo mb-24 mb-md-0"
            fxLayout="row" fxLayoutAlign="start center">
          <mat-icon class="logo-icon s-32 mr-16" [@animate]="{value:'*',params:{delay:'50ms',scale:'0.2'}}">
            insert_drive_file
          </mat-icon>
          <span class="logo-text h1" [@animate]="{value:'*',params:{delay:'100ms',x:'-25px'}}">
              Result Of Analysis
          </span>
      </div>
      <!-- / APP TITLE -->

      <!-- SEARCH -->
      <div class="search-wrapper mx-32 mx-md-0" [@animate]="{value:'*',params:{delay:'150ms',x:'-25px'}}">
        <div class="search" fxFlex fxLayout="row" fxLayoutAlign="start center">
            <mat-icon>search</mat-icon>
            <input 
            #filter 
            placeholder="Marketing Number" > 
        </div>
    </div>
    <!-- / SEARCH -->     

    <!-- ADD BUTTON -->
    <div style="margin-left: -20px;">
        <div style="display: flex; justify-content: center; align-items: center;">
            <button mat-mini-fab color="primary" [matMenuTriggerFor]="moreMenu" aria-label="More"
                                (click)="$event.stopPropagation();">
                <mat-icon class="secondary-text">drag_indicator</mat-icon>
            </button>
            <mat-menu #moreMenu="matMenu">
                <div class="column" mat-menu-item>
                    <button mat-menu-item aria-label="update" (click)="approveManager(this.draft)">
                        <mat-icon>check</mat-icon>
                        <span>Draft</span>
                    </button>
                </div>
                <div class="column" mat-menu-item>
                    <button mat-menu-item aria-label="update" (click)="approveManager(this.release)">
                        <mat-icon>check_circle</mat-icon>
                        <span>Release</span>
                    </button>
                </div>
            </mat-menu>
        </div>
    </div>
    <!-- END FILTER  --> 
    </div>
    <!-- / HEADER -->

      <!-- CONTENT CARD -->
    <div class="content-card" style="height: 70vh; overflow-y: auto;">
        <mat-table class="cert-table" #table [dataSource]="certData" matSort (matSortChange)="sortData($event)"
            [@animateStagger]="{value:'50'}" fusePerfectScrollbar>

            <!-- Column -->
            <ng-container matColumnDef="checkbox">
                <mat-header-cell *matHeaderCellDef mat-sort-header="checkbox"><mat-checkbox class="example-margin" 
                    (change)="setAll($event.checked)"
                    [indeterminate]="someComplete()"
                    ></mat-checkbox>
                </mat-header-cell>
                <mat-cell *matCellDef="let certData">
                    <mat-checkbox class="example-margin"
                    [(ngModel)]="certData.completed"
                    (ngModelChange)="updateAllComplete()"
                    (change)="checkBox($event.checked, certData.id)"
                    ></mat-checkbox>
                </mat-cell>
            </ng-container>

             <!-- Column -->
             <ng-container matColumnDef="contract_no">
                <mat-header-cell *matHeaderCellDef mat-sort-header="contract_no">Contract Number</mat-header-cell>
                <mat-cell *matCellDef="let certData">
                    <span (click)="contractDialog(certData.id)">
                        <p class="text-truncate"  matTooltip="{{certData.contract_no}}">{{ certData.contract_no }}</p>
                    </span>
                </mat-cell>
            </ng-container>

            <!-- Column -->
            <ng-container matColumnDef="lhu">
                <mat-header-cell *matHeaderCellDef mat-sort-header="lhu">LHU / CL</mat-header-cell>
                <mat-cell *matCellDef="let certData">
                    <div fxLayout="column">
                    <span class="text-truncate" matTooltip="{{certData.lhu_number}}">{{certData.lhu_number}}</span>
                    <span class="text-truncate" matTooltip="{{certData.cl_number}}"
                        style="color: f5f5f5; font-size: 10px; font-style: italic;">{{ certData.cl_number}}</span>
                    </div>
                </mat-cell>
            </ng-container>

             <!-- Column -->
             <ng-container matColumnDef="customer_name">
                <mat-header-cell *matHeaderCellDef mat-sort-header="customer_name">Customer</mat-header-cell>
                <mat-cell *matCellDef="let certData">
                        <p class="text-truncate" matTooltip="{{certData.customer}}">{{certData.customer}}</p>
                </mat-cell>
            </ng-container>

             <!-- Column -->
             <ng-container matColumnDef="tgl_selesai">
                <mat-header-cell *matHeaderCellDef mat-sort-header="tgl_selesai">Date of Completion</mat-header-cell>
                <mat-cell *matCellDef="let certData">
                    <p class="text-truncate">{{ certData.tgl_selesai | date }}</p>
                </mat-cell>
            </ng-container>

             <!-- Column -->
             <ng-container matColumnDef="sample_name">
                <mat-header-cell *matHeaderCellDef mat-sort-header="sample_name">Sample</mat-header-cell>
                <mat-cell *matCellDef="let certData">
                    <div fxLayout="column">
                    <span class="text-truncate" matTooltip="{{certData.sample_name}}">{{certData.sample_name}}</span>
                    <span class="text-truncate" matTooltip="{{certData.no_sample}}"
                        style="color: f5f5f5; font-size: 10px; font-style: italic;">{{ certData.no_sample}}</span>
                    </div>
                </mat-cell>
            </ng-container>

             <!-- Column -->
             <ng-container matColumnDef="status">
                <mat-header-cell *matHeaderCellDef mat-sort-header="status">S</mat-header-cell>
                <mat-cell *matCellDef="let certData">
                    <div *ngIf="certData.cert_status == 0"  matTooltip="roa">
                        <img style="width: 30%;" src="assets/icons/custom/file.svg" />
                    </div>
                    <div  *ngIf="certData.cert_status == 1"  matTooltip="draft">
                        <img style="width: 30%;" src="assets/icons/custom/draft.svg" />
                    </div>
                    <div  *ngIf="certData.cert_status == 2"  matTooltip="certificate">
                        <img style="width: 30%;" src="assets/icons/custom/certificate.svg" />
                    </div>
                </mat-cell>
            </ng-container>

             <!-- Column -->
             <ng-container matColumnDef="format">
                <mat-header-cell *matHeaderCellDef mat-sort-header="format">F</mat-header-cell>
                <mat-cell *matCellDef="let certData">
                    <span class="text-truncate" matTooltip="{{certData.format}}">{{certData.format}}</span>
                </mat-cell>
            </ng-container>

             <!-- Column -->
             <ng-container matColumnDef="action" >
                <mat-header-cell *matHeaderCellDef mat-sort-header="icon" fxHide fxShow.gt-md>#</mat-header-cell>
                <mat-cell *matCellDef="let certData; let indexOfelement=index;" fxHide fxShow.gt-md>
                    <div fxFlex="row" fxLayoutAlign="end center">
                        <button mat-icon-button color="primary" [matMenuTriggerFor]="moreMenu" aria-label="More"
                                (click)="$event.stopPropagation();">
                            <mat-icon class="secondary-text">drag_indicator</mat-icon>
                        </button>
                        <mat-menu #moreMenu="matMenu">
                            <div class="column" mat-menu-item>
                                <mat-grid-list cols="2" rowHeight="2:1">
                                    <mat-grid-tile> 
                                        <button mat-icon-button color="primary"  class="btn-icon-control" matTooltip="ID" aria-label="ID">
                                            <img style="width: 50%;" src="assets/images/flags/indonesia.svg" />
                                        </button>
                                    </mat-grid-tile>
                                    <mat-grid-tile>
                                        <button mat-icon-button color="primary"  class="btn-icon-control" matTooltip="EN" aria-label="EN"  style="margin-left: -10px;">
                                            <img style="width: 50%;" src="assets/images/flags/uk.svg" />
                                        </button>
                                    </mat-grid-tile>
                                </mat-grid-list>                                      
                            </div>
                            <button mat-menu-item aria-label="update" >
                                <mat-icon>create</mat-icon>
                                <span>Email</span>
                            </button>
                        </mat-menu>
                    </div>
                </mat-cell>
            </ng-container>

            <mat-header-row *matHeaderRowDef="displayedColumns; sticky:true"></mat-header-row>
            <mat-row *matRowDef="let certData; columns: displayedColumns;" 
            class="standart"
            matRipple>

            </mat-row>
        </mat-table>

        <mat-paginator #paginator
            [length]="total"
            [pageIndex]="from"
            [pageSize]="to"
            [hidePageSize]="true"
            [showFirstLastButtons]="true"
            (page) = "paginated($event)">

        </mat-paginator>

    </div>
    <!-- / CONTENT CARD -->

    </div>
    <!-- / CENTER -->
    
</div>