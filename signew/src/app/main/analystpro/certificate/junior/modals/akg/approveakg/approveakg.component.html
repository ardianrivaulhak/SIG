<div id="akg-lhu-approve" class="page-layout simple"  style="overflow: auto; height: 100%; background-color: #f7f7f7;" >
    <div class="content" style="overflow: auto;" >
        <mat-card class="mat-elevation-z0"  style="width: 98%; margin: 20px auto 10px auto;"  >
            <form name="resultForm" class="product w-100-p">
                <div fxLayout="column" fxLayoutAlign="space-evenly none">
                    <div fxLayout="row" fxLayoutAlign="space-between center" >
                        <mat-form-field appearance="outline" style="font-size: 11px;" fxFlex fxFlex="24">
                            <mat-label>Marketing</mat-label>
                            <input matInput 
                            #filter 
                            name="marketing"
                            [(ngModel)]="this.dataFilter.contract"
                            placeholder="Marketing Number">
                        </mat-form-field>
                        

                        <mat-form-field appearance="outline" style="font-size: 11px;" fxFlex fxFlex="24">
                            <mat-label>LHU Number</mat-label>
                            <input matInput 
                            #filter 
                            name="lhu"
                            [(ngModel)]="this.dataFilter.lhunumber"
                            placeholder="LHU Number">
                        </mat-form-field>

                        <mat-form-field appearance="outline" style="font-size: 11px" fxFlex="19" fxHide fxShow.gt-xs>
                            <mat-label>Status</mat-label>
                              <mat-select placeholder="Status"
                              [(ngModel)]="this.dataFilter.status"
                               name="status"
                                class="select-me"
                                style="display: flex;
                                justify-content: center;
                                align-items: center; 
                                color:white !important;">
                            </mat-select>
                        </mat-form-field>

                        <button mat-raised-button 
                        color="primary"  
                        fxFlex="15"  fxFlex.xs="15" 
                        (click)="search()"
                        style="height: 40px; width:250px; margin-right:15px; margin-bottom: 12px;">
                            Search
                        </button>
                        <button mat-stroked-button 
                        color="primary" 
                        (click)="resetSearch()"
                        fxFlex="15" fxFlex.xs="15" 
                        style="height: 40px;  margin-bottom: 12px;" >
                            Reset
                        </button>
                    </div>
                </div>
            </form>
        </mat-card>
        <mat-card class="mat-elevation-z0" style="width: 98%; margin: 20px auto 10px auto;" >
            <div fxLayout="row" fxLayoutAlign="space-between center" >
                <div style="margin-bottom:40px;">
                    <span style="font-size: 18px; font-weight: bolder; color: #303030; margin-right: 25px;" fxHide fxShow.gt-md>List Approve Nutrition Facts</span>
                </div>
                <div style="margin-bottom:40px;" fxLayout="row" fxLayoutAlign="space-evenly center" >
                <button mat-icon-button color="white"
                    *ngIf="this.checkList.length > 0"
                    class="contract-certficate"
                    (click)="submitData()"
                    matTooltip="Approve Selected Data"
                    [@animate]="{value:'*',params:{delay:'150ms',scale:'0.2'}}">
                    <mat-icon >check_circle</mat-icon>
                </button>
                <button mat-icon-button color="white"
                    *ngIf="this.checkList.length > 0"
                    class="contract-certficate"
                    matTooltip="Cancel"
                    (click)="cancelCheckList()"
                    [@animate]="{value:'*',params:{delay:'150ms',scale:'0.2'}}">
                    <mat-icon>cancel</mat-icon>
                </button>
                </div>
                
            </div>
            <mat-table class="sample-cert-table" #table [dataSource]="akgData" matSort (matSortChange)="sortData($event)"
                [@animate]="{value:'*',params:{delay:'120ms',y:'-25px'}}" fusePerfectScrollbar *ngIf="this.akgData.length > 0"> 

                  <!-- Column -->
                  <ng-container matColumnDef="checkbox">
                    <mat-header-cell *matHeaderCellDef>
                        <mat-checkbox class="example-margin" 
                        (change)="setAll($event.checked)"
                        (change)="someComplete()"
                        ></mat-checkbox>
                    </mat-header-cell>
                    <mat-cell *matCellDef="let akgData" >
                        <mat-checkbox class="example-margin"
                        [(ngModel)]="akgData.completed"
                        (ngModelChange)="updateAllComplete()"
                        (change)="checkBox($event.checked, akgData.id)"
                        ></mat-checkbox>
                    </mat-cell>
                </ng-container>


                <!-- Column -->
                <ng-container matColumnDef="marketing">
                    <mat-header-cell *matHeaderCellDef mat-sort-header="marketing">Contract Number</mat-header-cell>
                        <mat-cell *matCellDef="let akgData" >
                            <p class="text-truncate"  matTooltip="{{ akgData.contract.contract_no }}">{{ akgData.contract.contract_no }}</p>
                        </mat-cell>
                </ng-container>

                <!-- Column -->
                <ng-container matColumnDef="lhu">
                    <mat-header-cell *matHeaderCellDef mat-sort-header="lhu">LHU Number</mat-header-cell>
                        <mat-cell *matCellDef="let akgData" >
                            <p class="text-truncate"  matTooltip="{{ akgData.akg_detail[0].akg_in_lhu.lhu_number }}">{{ akgData.akg_detail[0].akg_in_lhu.lhu_number }}</p>
                        </mat-cell>
                </ng-container>


                <!-- Column -->
                <ng-container matColumnDef="format">
                    <mat-header-cell *matHeaderCellDef mat-sort-header="format">Format</mat-header-cell>
                        <mat-cell *matCellDef="let akgData" >
                            <p class="text-truncate"  matTooltip="{{ akgData.format_akg.name }}">{{ akgData.format_akg.name }}</p>
                        </mat-cell>
                </ng-container>

                 <!-- Column -->
                 <ng-container matColumnDef="status">
                    <mat-header-cell *matHeaderCellDef mat-sort-header="status">Status</mat-header-cell>
                        <mat-cell *matCellDef="let akgData">

                            <div *ngIf="this.akgData.akg_condition[this.akgData.akg_condition.length - 1].position == 1 && 
                            this.akgData.akg_condition[this.akgData.akg_condition.length - 1].status == 0" 
                            fxLayout="row" fxLayoutAlign="space-evenly center">
                                <span style="height: 15px;
                                    width: 15px;
                                    background-color: #686868;
                                    border-radius: 50%;
                                    display: inline-block;
                                    margin-right:5px;"></span>
                                <p class="text-truncate" matTooltip="New">                                
                                    New
                                </p>
                            </div>

                            <div *ngIf="this.akgData.akg_condition[this.akgData.akg_condition.length - 1].position == 1 && 
                            this.akgData.akg_condition[this.akgData.akg_condition.length - 1].status == 1" 
                            fxLayout="row" fxLayoutAlign="space-evenly center">
                                <span style="height: 15px;
                                    width: 15px;
                                    background-color: #ffad0a;
                                    border-radius: 50%;
                                    display: inline-block;
                                    margin-right:5px;"></span>
                                <p class="text-truncate" matTooltip="Waiting">                                
                                    Waiting
                                </p>
                            </div>

                            <div *ngIf="this.akgData.akg_condition[this.akgData.akg_condition.length - 1].position == 2 && 
                            this.akgData.akg_condition[this.akgData.akg_condition.length - 1].status == 1" 
                            fxLayout="row" fxLayoutAlign="space-evenly center">
                                <span style="height: 15px;
                                    width: 15px;
                                    background-color: #3EB049;
                                    border-radius: 50%;
                                    display: inline-block;
                                    margin-right:5px;"></span>
                                <p class="text-truncate" matTooltip="Approved">                                
                                    Approved
                                </p>
                            </div>

                        </mat-cell>
                </ng-container>

                 <!-- Column -->
                 <ng-container matColumnDef="inserted_at">
                    <mat-header-cell *matHeaderCellDef mat-sort-header="inserted_at">Insert Date</mat-header-cell>
                        <mat-cell *matCellDef="let akgData" >
                            <p class="text-truncate"  matTooltip="{{ akgData.created_at | date }}">{{ akgData.created_at | date }}</p>
                        </mat-cell>
                </ng-container>

                 <!-- Column -->
                 <ng-container matColumnDef="user">
                    <mat-header-cell *matHeaderCellDef mat-sort-header="user">User</mat-header-cell>
                        <mat-cell *matCellDef="let akgData" >
                            <p class="text-truncate"  matTooltip="{{this.akgData.akg_condition[this.akgData.akg_condition.length - 1].user.employee_name}}">{{ this.akgData.akg_condition[this.akgData.akg_condition.length - 1].user.employee_name }}</p>
                        </mat-cell>
                </ng-container>

                 <!-- Column -->
                 <ng-container matColumnDef="action">
                    <mat-header-cell *matHeaderCellDef mat-sort-header="action"></mat-header-cell>
                        <mat-cell *matCellDef="let akgData" >
                            <!-- <button mat-icon-button>
                                <mat-icon style="color:#3EB049">check_circle</mat-icon>
                            </button> -->
                            <button mat-icon-button (click)="goToAkg(akgData.id)">
                                <mat-icon>visibility</mat-icon>
                            </button>
                        </mat-cell>
                </ng-container>

                <mat-header-row *matHeaderRowDef="displayedColumns; sticky:true"></mat-header-row>
                <mat-row *matRowDef="let dataSampleLab; columns: displayedColumns;"
                class="standart"
                matRipple>
                </mat-row>
            </mat-table>

            <div [@animate]="{value:'*',params:{delay:'100ms',x:'-25px'}}">
                <mat-paginator #paginator
                [length]="total"
                [pageIndex]="from"
                [pageSize]="to"
                [hidePageSize]="true"
                [showFirstLastButtons]="true"
                (page) = "paginated($event)"
                style="font-size: 10px;"
                *ngIf="this.total > 0">
    
                </mat-paginator>
            </div>
            
            <div *ngIf="loadingfirst && this.akgData.length === 0" style="width: 15%; margin-left: auto; margin-right: auto; margin-top: auto; margin-bottom: auto; display: block; text-align: center;">
                <img  src="assets/images/gif/loading.gif" />
                <small>Please Wait ...</small>
            </div>
    
            <div *ngIf="!loadingfirst && this.akgData.length === 0" style="width: 15%; margin-left: auto; margin-right: auto; margin-top: auto; margin-bottom: auto; display: block; text-align: center;">
                <img  src="assets/images/gif/selectfile.gif" />
                <small>No Data</small>
            </div>

            
        </mat-card>
    </div>
</div>