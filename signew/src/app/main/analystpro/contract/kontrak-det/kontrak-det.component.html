<div id="kontrakuji" *ngIf="test" style="background-color: #f1f5f9">
    <form name="contractForm" [formGroup]="contractForm">
        <div
            fxFlex
            fxLayout="column"
            fxLayoutAlign="center flex-start"
            style="flex: 1"
        >
            <mat-card
                class="mat-elevation-z0 rounded-2x1"
                style="width: 98%; margin: 15px auto 10px auto; height: auto"
            >
                <div fxLayout="row" fxLayoutAlign="space-between center">
                    <div style="margin-bottom: 10px">
                        <mat-card-title>
                            <button
                                mat-icon-button
                                [routerLink]="'/analystpro/contract'"
                            >
                                <mat-icon>keyboard_arrow_left</mat-icon>
                            </button>
                            <span
                                style="
                                    font-size: 18px;
                                    font-weight: bolder;
                                    color: #303030;
                                "
                                fxShow.gt-md
                                >Customer Detail</span
                            >
                        </mat-card-title>
                    </div>
                    <div
                        style="margin-bottom: 10px"
                        fxLayout="row"
                        fxLayoutAlign="space-evenly center"
                    >
                        <button
                            mat-icon-button
                            color="white"
                            matTooltip="Add Customer"
                            (click)="modalcustomerhandle()"
                        >
                            <mat-icon>people</mat-icon>
                        </button>
                        <button
                            mat-icon-button
                            color="white"
                            matTooltip="Add Customer Address"
                            (click)="modaladdresscustomer()"
                            [disabled]="
                                this.contractForm.value.customerhandle
                                    ? false
                                    : true
                            "
                        >
                            <mat-icon> location_on</mat-icon>
                        </button>
                    </div>
                </div>
                <div fxLayout="row" fxLayoutAlign="start center">
                    <ng-select
                        fxFlex="33"
                        appearance="outline"
                        appendTo="body"
                        [items]="customerhandle"
                        bindLabel="customer_name"
                        bindValue="idch"
                        placeholder="Select Customer"
                        (scrollToEnd)="onScrollToEnd('customer')"
                        formControlName="customerhandle"
                        (search)="onSearchi($event, 'customer')"
                        (clear)="reset()"
                        (change)="getValue($event, 'customer')"
                        dropdownPosition="bottom"
                        style="
                            width: 100%;
                            max-width: 400px;
                            margin-right: 15px;
                        "
                        required
                    >
                        <ng-template
                            ng-option-tmp
                            let-item="item"
                            let-index="index"
                        >
                            <div
                                title="{{ item.customer_name }} - {{
                                    item.name
                                }}"
                            >
                                <b>{{ item.kode_customer }}</b
                                >&nbsp;-&nbsp;{{
                                    item.customer_name
                                }}&nbsp;-&nbsp;{{ item.name }}
                            </div>
                        </ng-template>
                        <ng-template ng-label-tmp let-item="item">
                            <div
                                title="{{ item.customer_name }} - {{
                                    item.name
                                }}"
                            >
                                <b>{{ item.kode_customer }}</b
                                >&nbsp;-&nbsp;{{
                                    item.customer_name
                                }}&nbsp;-&nbsp;{{ item.name }}
                            </div>
                        </ng-template>
                    </ng-select>
                    <ng-select
                        fxFlex="33"
                        *ngIf="!showsurabaya"
                        appendTo="body"
                        [items]="datapenawaran"
                        appearance="outline"
                        bindLabel="no_penawaran"
                        bindValue="id"
                        formControlName="penawaran"
                        placeholder="Select Penawaran"
                        (change)="getValue($event, 'penawaran')"
                        dropdownPosition="bottom"
                        style="width: 100%; margin-right: 15px"
                        required
                    >
                        <ng-template
                            ng-option-tmp
                            let-item="item"
                            let-index="index"
                        >
                            <b>{{ item.no_penawaran }}</b
                            >&nbsp;-&nbsp;{{ item.employee }}
                        </ng-template>
                        <ng-template ng-label-tmp let-item="item">
                            <b>{{ item.no_penawaran }}</b
                            >&nbsp;-&nbsp;{{ item.employee }}
                        </ng-template>
                    </ng-select>
                    <mat-form-field
                        fxFlex="33"
                        appearance="outline"
                        style="
                            width: 100% !important;
                            align-self: center;
                            padding-bottom: 10px;
                            font-size: 102%;
                        "
                    >
                        <mat-label>Nomer PO</mat-label>
                        <input matInput formControlName="no_po" />
                    </mat-form-field>
                </div>
                <div
                    FxLayout="row"
                    fxLayoutAlign="start center"
                    style="margin-bottom: 5px"
                >
                    <ng-select
                        fxFlex="50"
                        appearance="outline"
                        appendTo="body"
                        [items]="dataemployee"
                        bindLabel="employee_name"
                        bindValue="employee_id"
                        placeholder="Select Sales / Marketing"
                        formControlName="clienthandling"
                        (search)="onSearchi($event, 'employee')"
                        dropdownPosition="bottom"
                        style="width: 100%; margin-right: 15px"
                        required
                    >
                        <ng-template
                            ng-option-tmp
                            let-item="item"
                            let-index="index"
                        >
                            {{ item.employee_name }}
                        </ng-template>
                        <ng-template ng-label-tmp let-item="item">
                            {{ item.employee_name }}
                        </ng-template>
                    </ng-select>
                    <ng-select
                        fxFlex="50"
                        appearance="outline"
                        style="max-width: 500px; width: 100%"
                        class="wrap"
                        appendTo="body"
                        [items]="alamatcustomer"
                        bindLabel="address"
                        bindValue="id_address"
                        placeholder="Select Address"
                        formControlName="alamatcustomer"
                        (search)="onSearchi($event, 'address')"
                        (change)="getValue($event, 'alamat')"
                        dropdownPosition="bottom"
                    >
                        <ng-template
                            ng-option-tmp
                            let-item="item"
                            let-index="index"
                        >
                            <div
                                title="{{ item.address }}{{
                                    item.desc ? ' - ' + item.desc : ''
                                }}"
                            >
                                {{ item.address
                                }}{{ item.desc ? " - " + item.desc : "" }}
                            </div>
                        </ng-template>
                        <ng-template ng-label-tmp let-item="item">
                            <div
                                title="{{ item.address }}{{
                                    item.desc ? ' - ' + item.desc : ''
                                }}"
                            >
                                {{ item.address
                                }}{{ item.desc ? " - " + item.desc : "" }}
                            </div>
                        </ng-template>
                    </ng-select>
                </div>
                <div
                    FxLayout="row"
                    fxLayoutAlign="start center"
                    *ngIf="this.datacustomerhandle.length > 0"
                >
                    <!-- <mat-form-field appearance="outline" style="margin-right: 15px;">
                            <mat-label>Local Phone</mat-label>
                            <input
                                matInput
                                [ngClass]="
                                    this.toldeditcustomerhandle
                                        ? 'actived-input'
                                        : 'disabled-input'
                                "
                                [disabled]="this.disableditcustomerhandle"
                                [(ngModel)]="telponcustomerhandle"
                            />
                            <mat-icon matSuffix>local_phone</mat-icon>
                        </mat-form-field>
                        <mat-form-field appearance="outline" style="margin-right: 15px;">
                            <mat-label>Mobile Phone</mat-label>
                            <input
                                matInput
                                [ngClass]="
                                    this.toldeditcustomerhandle
                                        ? 'actived-input'
                                        : 'disabled-input'
                                "
                                [disabled]="this.disableditcustomerhandle"
                                [(ngModel)]="phonecustomerhandle"
                            />
                            <mat-icon matSuffix>phone_android</mat-icon>
                        </mat-form-field>
                        <mat-form-field appearance="outline" style="margin-right: 15px;">
                            <mat-label>Email</mat-label>
                            <input
                                matInput
                                [ngClass]="
                                    this.toldeditcustomerhandle
                                        ? 'actived-input'
                                        : 'disabled-input'
                                "
                                [disabled]="this.disableditcustomerhandle"
                                [(ngModel)]="emailcustomerhandle"
                            />
                            <mat-icon matSuffix>email</mat-icon>
                        </mat-form-field>
                    <div *ngIf="this.disableditcustomerhandle" >
                        <button
                            mat-raised-button
                            (click)="editcustomerhandle()"
                            style="margin-right: 15px;"
                        >
                            Edit
                        </button>
                        <button mat-raised-button (click)="closesession()">
                            Close
                        </button>
                    </div>
                    <div *ngIf="!this.disableditcustomerhandle">
                        <button
                            mat-raised-button
                            color="danger"
                            (click)="canceleditcustomerhandle()"
                            style="margin-right: 15px;"
                        >
                            Cancel
                        </button>
                        <button
                            mat-raised-button
                            color="primary"
                            (click)="saveditcustomerhandle()"
                        >
                            Save
                        </button>
                    </div> -->
                    <mat-form-field
                        fxFlex="30"
                        appearance="outline"
                        matTooltip="Telp"
                        style="
                            width: 100% !important;
                            align-self: center;
                            font-size: 14px;
                            margin-right: 15px;
                        "
                    >
                        <mat-label>
                            <mat-icon> call</mat-icon>
                            {{
                                this.datacustomerhandle[0].telpnumber
                            }}</mat-label
                        >
                        <input matInput disabled />
                    </mat-form-field>
                    <mat-form-field
                        fxFlex="30"
                        appearance="outline"
                        matTooltip="Contact Person"
                        style="
                            width: 100% !important;
                            align-self: center;
                            font-size: 14px;
                            margin-right: 15px;
                        "
                    >
                        <mat-label>
                            <mat-icon> contacts</mat-icon>
                            {{
                                this.datacustomerhandle[0].phonenumber
                            }}</mat-label
                        >
                        <input matInput disabled />
                    </mat-form-field>
                    <mat-form-field
                        fxFlex="30"
                        appearance="outline"
                        matTooltip="Email"
                        style="
                            width: 100% !important;
                            align-self: center;
                            font-size: 14px;
                            margin-right: 15px;
                        "
                    >
                        <mat-label
                            ><mat-icon> email</mat-icon>
                            {{ this.datacustomerhandle[0].email }}</mat-label
                        >
                        <input matInput disabled />
                    </mat-form-field>
                    <button
                        mat-stroked-button
                        style="
                            width: 15%;
                            align-self: center;
                            padding-bottom: 10px;
                            font-size: 102%;
                        "
                        (click)="(setEnable)"
                        matTooltip=" Edit Contact Customer"
                    >
                        <mat-icon>edit</mat-icon>
                    </button>
                </div>

                <div FxLayout="row" fxLayoutAlign="start center">
                    <button
                        mat-stroked-button
                        *ngIf="!this.contractForm.controls.valuenpwpktp.value"
                        color="primary"
                        style="width: 100%"
                        (click)="tambahnpwpktp()"
                    >
                        Add KTP/NPWP
                    </button>
                </div>
                <div
                    FxLayout="row"
                    fxLayoutAlign="start center"
                    style="width: 100%"
                    fxLayoutGap="15px"
                    *ngIf="this.contractForm.controls.valuenpwpktp.value"
                >
                    <table
                        class="sample"
                        #table
                        mat-table
                        style="width: 100%"
                        [dataSource]="this.customerNpwpData"
                    >
                        <ng-container matColumnDef="no">
                            <th mat-header-cell *matHeaderCellDef>
                                <button
                                    mat-icon-button
                                    color="white"
                                    matTooltip="Add NPWP or KTP"
                                    (click)="tambahnpwpktp()"
                                >
                                    <mat-icon>add_box</mat-icon>
                                </button>
                            </th>
                            <td mat-cell *matCellDef>#</td>
                        </ng-container>

                        <ng-container matColumnDef="action">
                            <th mat-header-cell *matHeaderCellDef>Type</th>
                            <td mat-cell *matCellDef="let e; let g = index">
                                <p>
                                    {{
                                        this.contractForm.controls.valuenpwpktp
                                            .value
                                            ? this.contractForm.controls.valuenpwpktp.value.toUpperCase()
                                            : ""
                                    }}
                                </p>
                            </td>
                        </ng-container>

                        <ng-container matColumnDef="samplename">
                            <th mat-header-cell *matHeaderCellDef>Number</th>
                            <td mat-cell *matCellDef="let e; let g = index">
                                <p>
                                    {{
                                        this.contractForm.controls.numbernpwpktp
                                            .value
                                            ? this.contractForm.controls.numbernpwpktp.value.toUpperCase()
                                            : ""
                                    }}
                                </p>
                            </td>
                        </ng-container>

                        <tr
                            mat-header-row
                            *matHeaderRowDef="displayedColumns"
                        ></tr>
                        <tr
                            mat-row
                            *matRowDef="let row; columns: displayedColumns"
                        ></tr>
                    </table>
                    <!-- <mat-form-field
                        appearance="outline"
                        style="width: 100%; margin-right: 15px"
                    >
                        <mat-label>Choose an option</mat-label>
                        <mat-select formControlName="valuenpwpktp">
                            <mat-option value="ktp">KTP</mat-option>
                            <mat-option value="npwp">NPWP</mat-option>
                        </mat-select>
                    </mat-form-field>
                    <mat-form-field style="width: 100%" appearance="outline">
                        <mat-label
                            >{{
                                this.contractForm.controls.valuenpwpktp.value
                                    ? this.contractForm.controls.valuenpwpktp.value.toUpperCase()
                                    : ""
                            }}
                            Number</mat-label
                        >
                        <input matInput formControlName="numbernpwpktp" />
                    </mat-form-field> -->
                </div>
            </mat-card>

            <mat-card
                class="mat-elevation-z0 rounded-2x1"
                style="width: 98%; margin: 15px auto 10px auto; height: auto"
            >
                <div style="margin-bottom: 20px">
                    <span
                        style="
                            font-size: 18px;
                            font-weight: bolder;
                            color: #303030;
                        "
                        fxShow.gt-md
                        >Contract Detail</span
                    >
                </div>
                <div fxLayout="row" fxLayoutAlign="start center">
                    <ng-select
                        fxFlex="50"
                        appendTo="body"
                        [items]="contract_category"
                        appearance="outline"
                        bindLabel="title"
                        bindValue="id"
                        formControlName="contract_category"
                        placeholder="Select Contract Type"
                        (change)="getValue($event, 'contractcategory')"
                        dropdownPosition="bottom"
                        style="width: 100%; margin-right: 15px"
                        required
                    >
                    </ng-select>
                    <ng-select
                        appearance="outline"
                        appendTo="body"
                        [items]="typeContract"
                        bindLabel="type"
                        bindValue="id"
                        placeholder="Select Sample Source"
                        formControlName="typeContract"
                        (change)="getValue($event, 'typecontract')"
                        dropdownPosition="bottom"
                        style="width: 100%"
                        required
                    >
                        <ng-template
                            ng-option-tmp
                            let-item="item"
                            let-index="index"
                        >
                            <b>{{ item.id }}</b
                            >&nbsp;-&nbsp;{{ item.type }}
                        </ng-template>
                        <ng-template ng-label-tmp let-item="item">
                            <b>{{ item.id }}</b
                            >&nbsp;-&nbsp;{{ item.type }}
                        </ng-template>
                    </ng-select>
                    <!-- <mat-form-field
                        appearance="outline"
                        style="margin-right: 15px; width: 100%; margin-bottom: 10px;"
                    >
                        <mat-select placeholder="Select Contract Type">
                            <mat-option>

                                <ngx-mat-select-search
                                fxFlex="50"
                                appendTo="body"
                                [formControlName]="contract_category"
                                ariaLabel="dropdown search"
                                (change)="
                                    getValue($event, 'contractcategory')
                                "
                                
                                placeholderLabel="Select Contract Type"
                            ></ngx-mat-select-search>
                            </mat-option>
                           
                            <mat-option
                                *ngFor="let contract of contract_category"
                                [value]="contract.id"
                            >
                                {{ contract.title }}
                            </mat-option>
                        </mat-select>
                    </mat-form-field> -->

                    <!-- <mat-form-field
                        fxFlex="50"
                        appearance="outline"
                        style="width: 100% !important; align-self: center; margin-bottom: 10px;"
                    >
                        <mat-label>No Penawaran</mat-label>
                        <input matInput formControlName="no_penawaran" />
                    </mat-form-field> -->

                    <!-- <ng-select
                        fxFlex="50"
                        appearance="outline"
                        appendTo="body"
                        [items]="typeContract"
                        bindLabel="type"
                        bindValue="id"
                        placeholder="Select Sample Source"
                        formControlName="typeContract"
                        (change)="getValue($event, 'typecontract')"
                        dropdownPosition="bottom"
                        style="width: 100%"
                        required
                    >
                        <ng-template
                            ng-option-tmp
                            let-item="item"
                            let-index="index"
                        >
                            <b>{{ item.id }}</b
                            >&nbsp;-&nbsp;{{ item.type }}
                        </ng-template>
                        <ng-template ng-label-tmp let-item="item">
                            <b>{{ item.id }}</b
                            >&nbsp;-&nbsp;{{ item.type }}
                        </ng-template>
                    </ng-select> -->
                </div>

                <div FxLayout="row" fxLayoutAlign="start center">
                    <mat-form-field
                        fxFlex="33"
                        appearance="outline"
                        floatLabel="always"
                        class="w-100-p"
                        style="margin-right: 15px"
                    >
                        <mat-label>Memo Finance</mat-label>
                        <textarea
                            matInput
                            formControlName="memo_finance"
                            placeholder="Memo Finance"
                            name="desc"
                            rows="2"
                        >
                        </textarea>
                    </mat-form-field>
                    <mat-form-field
                        fxFlex="33"
                        appearance="outline"
                        floatLabel="always"
                        class="w-100-p"
                        style="margin-right: 15px"
                    >
                        <mat-label>Internal Description</mat-label>
                        <textarea
                            matInput
                            formControlName="desc_internal"
                            placeholder="Internal Description"
                            name="desc"
                            rows="2"
                        >
                        </textarea>
                    </mat-form-field>
                    <mat-form-field
                        fxFlex="33"
                        appearance="outline"
                        floatLabel="always"
                        class="w-100-p"
                    >
                        <mat-label>External Description</mat-label>
                        <textarea
                            matInput
                            formControlName="desc"
                            placeholder="External Description"
                            name="desc"
                            rows="2"
                        >
                        </textarea>
                    </mat-form-field>

                    <mat-form-field
                        appearance="outline"
                        floatLabel="always"
                        class="w-100-p"
                    >
                        <mat-label>Memo Finance</mat-label>
                        <textarea
                            matInput
                            formControlName="memo_finance"
                            placeholder="Memo Finance"
                            name="desc"
                            rows="2"
                        >
                        </textarea>
                    </mat-form-field>

                    <!-- <h3>File Attachment</h3>
                    <div
                        fxFlex
                        fxLayout="row"
                        fxLayoutAlign="flex-start center"
                        style="width: 100%"
                    >
                        <div
                            class="box-photo"
                            style="background-color: #039be5"
                            (click)="addfoto()"
                        >
                            <mat-icon style="width: 25px"
                                >add_circle_outline</mat-icon
                            >
                        </div>
                        <div
                            *ngFor="
                                let u of contractForm.controls['foto'].controls;
                                let indexPoint = index
                            " formArrayName="foto"
                        >
                            <div
                                class="box-photo"
                                [matMenuTriggerFor]="menu"
                                [formGroupName]="indexPoint"
                            >
                                <div *ngIf="!u.value.photo">
                                    <mat-icon style="width: 25px"
                                        >add_a_photo</mat-icon
                                    >
                                </div>

                                <div *ngIf="u.value.type == 'webcam' && u.value.photo">
                                    <img
                                        *ngIf="
                                            u.value.photo
                                                .toLowerCase()
                                                .indexOf('.') > -1
                                        "
                                        src="{{
                                            this.urlapi +
                                                this.contrak_no +
                                                '/attachment/' +
                                                u.value.photo
                                        }}"
                                        style="
                                            flex: 1;
                                            width: 100px;
                                            height: 100px;
                                            border-radius: 10px;
                                            object-fit: cover;
                                        "
                                    />
                                    <img
                                        *ngIf="
                                            u.value.photo
                                                .toLowerCase()
                                                .indexOf('.') < 1
                                        "
                                        src="{{ u.value.photo }}"
                                        style="
                                            flex: 1;
                                            width: 100px;
                                            height: 100px;
                                            border-radius: 10px;
                                            object-fit: cover;
                                        "
                                    />
                                </div>
                                <div *ngIf="u.value.photo && u.value.type == 'file'" title="{{u.value.name}}">
                                    <img
                                        src="assets/images/avatars/document.png"
                                        style="
                                            flex: 1;
                                            width: 100px;
                                            height: 100px;
                                            border-radius: 10px;
                                            object-fit: cover;
                                        "
                                    />
                                </div>
                            </div>
                            <mat-menu #menu="matMenu">
                                <button
                                    mat-menu-item
                                    (click)="openfoto(u.value.photo)" *ngIf="u.value.photo"
                                >
                                    <span>Lihat Gambar</span>
                                </button>
                                <input
                                    #_fileInput
                                    type="file"
                                    (change)="uploadFile($event, indexPoint)"
                                    hidden
                                />
                                <button
                                    mat-menu-item
                                    (click)="_fileInput.click()"
                                >
                                    <span>Upload File</span>
                                </button>
                                <button
                                    mat-menu-item
                                    (click)="_uploadGambar($event, indexPoint)"
                                >
                                    <span>Take Photo</span>
                                </button>
                            </mat-menu>
                        </div>
                    </div> -->
                    >>>>>>>>> Temporary merge branch 2
                </div>
            </mat-card>

            <mat-card
                class="mat-elevation-z0 rounded-2x1"
                style="
                    width: 98%;
                    margin: 15px auto 10px auto;
                    height: 500px;
                    overflow: auto;
                "
            >
                <div fxLayout="row" fxLayoutAlign="space-between center">
                    <div style="margin-bottom: 40px">
                        <span
                            style="
                                font-size: 18px;
                                font-weight: bolder;
                                color: #303030;
                                margin-right: 25px;
                            "
                            fxShow.gt-md
                            >Sample Details</span
                        >
                    </div>
                    <div
                        style="margin-bottom: 40px"
                        fxLayout="row"
                        fxLayoutAlign="space-evenly center"
                    >
                        <button
                            matTooltip="Paste All"
                            mat-icon-button
                            [disabled]="this.copydata.length < 1 ? true : false"
                            (click)="pasteall()"
                        >
                            <mat-icon>file_copy</mat-icon>
                        </button>
                        <button
                            mat-icon-button
                            color="white"
                            class="add-leave"
                            matTooltip="Tambah Jumlah Sample"
                            (click)="tambah()"
                        >
                            <mat-icon>add_circle</mat-icon>
                        </button>
                        <input
                            style="
                                height: 25px;
                                border: 1px solid #737373;
                                width: 35%;
                                border-radius: 5px;
                                margin: -20px;
                                text-align: center;
                            "
                            formControlName="jumlahsample"
                            (keyup.enter)="changeval($event.target.value)"
                        />
                        <button
                            mat-icon-button
                            color="white"
                            class="add-leave"
                            matTooltip="Kurangi Jumlah Sample"
                            (click)="kurang()"
                        >
                            <mat-icon>remove_circle</mat-icon>
                        </button>
                    </div>
                </div>
                <div class="table-responsive" style="overflow: hidden">
                    <table
                        class="sample"
                        #table
                        mat-table
                        style="width: 100%"
                        [dataSource]="
                            this.contractForm.controls.sample['controls']
                        "
                        formArrayName="sample"
                    >
                        <ng-container matColumnDef="no">
                            <th mat-header-cell *matHeaderCellDef>No</th>
                            <td mat-cell *matCellDef="let e; let i = index">
                                {{ i + 1 }}
                            </td>
                        </ng-container>

                        <ng-container matColumnDef="samplename">
                            <th mat-header-cell *matHeaderCellDef>
                                Sample Name
                            </th>
                            <td
                                mat-cell
                                *matCellDef="let e; let g = index"
                                [formGroupName]="g"
                            >
                                <mat-form-field
                                    appearance="outline"
                                    style="
                                        width: 100%;
                                        font-size: 12px;
                                        font-weight: bold;
                                        padding: 5px;
                                    "
                                >
                                    <mat-label>Sample Name</mat-label>
                                    <textarea
                                        matInput
                                        formControlName="samplename"
                                    ></textarea>
                                </mat-form-field>
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="action">
                            <th mat-header-cell *matHeaderCellDef>Action</th>
                            <td mat-cell *matCellDef="let e; let z = index">
                                <button
                                    mat-icon-button
                                    matTooltip="Copy"
                                    (click)="copythis(e, z)"
                                    [disabled]="
                                        e.value.samplename ? false : true
                                    "
                                >
                                    <mat-icon>insert_drive_file</mat-icon>
                                </button>
                                <button
                                    matTooltip="Paste"
                                    mat-icon-button
                                    [disabled]="
                                        this.copydata.length < 1 ? true : false
                                    "
                                    (click)="pastethis(e, z)"
                                >
                                    <mat-icon>file_copy</mat-icon>
                                </button>
                                <button
                                    matTooltip="Add Parameter"
                                    mat-icon-button
                                    (click)="openModalParameter(e, z)"
                                    [disabled]="this.setAddParameter"
                                >
                                    <mat-icon>launch</mat-icon>
                                </button>
                                <button
                                    matTooltip="Delete Sample"
                                    *ngIf="this.idContrack === 'add'"
                                    mat-icon-button
                                    color="warn"
                                    (click)="deleteRow(z)"
                                >
                                    <mat-icon>delete</mat-icon>
                                </button>
                            </td>
                        </ng-container>
                        <tr
                            mat-header-row
                            *matHeaderRowDef="displayedColumns"
                        ></tr>
                        <tr
                            mat-row
                            *matRowDef="let row; columns: displayedColumns"
                        ></tr>
                    </table>
                </div>
            </mat-card>

            <mat-card
                class="mat-elevation-z0 rounded-2x1"
                style="width: 98%; margin: 15px auto 10px auto; height: auto"
            >
                <div style="margin-bottom: 20px">
                    <span
                        style="
                            font-size: 18px;
                            font-weight: bolder;
                            color: #303030;
                        "
                        fxShow.gt-md
                        >Pricing Detail</span
                    >
                </div>
                <div fxLayout="row" fxLayoutAlign="center center">
                    <table class="pricing-table">
                        <tr>
                            <td
                                colspan="2"
                                style="text-align: left; font-weight: bold"
                            >
                                Total Biaya Pengujian
                            </td>
                            <td style="text-align: right">
                                <span *ngIf="this.btnTotalpembayaran">
                                    Rp.
                                    {{
                                        this.contractForm.controls
                                            .totalpembayaran.value
                                            ? this.contractForm.controls.totalpembayaran.value.toLocaleString()
                                            : 0
                                    }}
                                </span>
                                <div *ngIf="!this.btnTotalpembayaran">
                                    Rp.<input
                                        type="text"
                                        matInput
                                        currencyMask
                                        formControlName="totalpembayaran"
                                        style="margin-right: 10px; width: 100px"
                                        [options]="{
                                            prefix: '',
                                            thousands: '.',
                                            precision: 0
                                        }"
                                    />
                                </div>
                            </td>
                        </tr>
                        <!-- <tr>
                            <td
                                colspan="3"
                                style="text-align: left; font-weight: bold"
                            ></td>
                        </tr> -->

                        <tr>
                            <td
                                colspan="2"
                                style="text-align: left; font-weight: bold"
                            >
                                Biaya Sampling
                                <button
                                    mat-icon-button
                                    (click)="gotosampling()"
                                >
                                    <mat-icon>error</mat-icon>
                                </button>
                            </td>
                            <td style="text-align: right">
                                <div
                                    style="
                                        display: flex;
                                        flex-direction: row;
                                        justify-content: flex-end;
                                        align-items: center;
                                    "
                                >
                                    <span>Rp.</span>
                                    <input
                                        type="text"
                                        matInput
                                        currencyMask
                                        style="width: 200px"
                                        formControlName="biayasample"
                                        [options]="{
                                            prefix: '',
                                            thousands: '.',
                                            precision: 0
                                        }"
                                    />
                                </div>
                            </td>
                        </tr>

                        <tr>
                            <td
                                colspan="2"
                                style="text-align: left; font-weight: bold"
                            >
                                Discount
                            </td>
                            <td style="text-align: right">
                                <div
                                    style="
                                        display: flex;
                                        flex-direction: row;
                                        justify-content: flex-end;
                                        align-items: center;
                                    "
                                >
                                    <input
                                        type="number"
                                        matInput
                                        step="any"
                                        formControlName="discount"
                                        (keyup)="setHasilDiscount($event)"
                                        style="margin-right: 10px; width: 50px"
                                    />
                                    <span style="margin-right: 50px">% </span>
                                    <span>Rp.</span>
                                    <input
                                        type="text"
                                        matInput
                                        currencyMask
                                        formControlName="hasilDiscount"
                                        style="width: 200px"
                                        (keyup)="setDiscount($event)"
                                        [options]="{
                                            prefix: '',
                                            thousands: '.',
                                            precision: 0
                                        }"
                                    />
                                </div>
                            </td>
                        </tr>

                        <tr>
                            <td
                                colspan="2"
                                style="text-align: left; font-weight: bold"
                            >
                                Biaya AKG
                                <button mat-icon-button (click)="gotoakg()">
                                    <mat-icon>error</mat-icon>
                                </button>
                            </td>
                            <td style="text-align: right">
                                <div
                                    style="
                                        display: flex;
                                        flex-direction: row;
                                        justify-content: flex-end;
                                        align-items: center;
                                    "
                                >
                                    <span>Rp.</span>
                                    <input
                                        type="text"
                                        matInput
                                        currencyMask
                                        style="width: 200px"
                                        formControlName="biayaakg"
                                        [options]="{
                                            prefix: '',
                                            thousands: '.',
                                            precision: 0
                                        }"
                                    />
                                </div>
                            </td>
                        </tr>

                        <tr>
                            <td
                                colspan="2"
                                style="text-align: left; font-weight: bold"
                            >
                                Subtotal
                            </td>
                            <td style="text-align: right">
                                <div
                                    style="
                                        display: flex;
                                        flex-direction: row;
                                        justify-content: flex-end;
                                        align-items: center;
                                    "
                                >
                                    <span>Rp.</span>
                                    <input
                                        type="text"
                                        matInput
                                        currencyMask
                                        formControlName="totaltanpappn"
                                        style="width: 200px"
                                        [options]="{
                                            prefix: '',
                                            thousands: '.',
                                            precision: 0
                                        }"
                                    />
                                </div>
                            </td>
                        </tr>

                        <tr>
                            <td
                                colspan="2"
                                style="text-align: left; font-weight: bold"
                            >
                                PPN 11%
                                <mat-checkbox
                                    class="example-margin"
                                    formControlName="formppn"
                                    (change)="setPpn($event.checked)"
                                ></mat-checkbox>
                            </td>
                            <td style="text-align: right">
                                <div
                                    style="
                                        display: flex;
                                        flex-direction: row;
                                        justify-content: flex-end;
                                        align-items: center;
                                    "
                                >
                                    <span>Rp.</span>
                                    <input
                                        type="text"
                                        matInput
                                        currencyMask
                                        formControlName="ppn"
                                        style="width: 200px"
                                        [options]="{
                                            prefix: '',
                                            thousands: '.',
                                            precision: 0
                                        }"
                                    />
                                </div>
                            </td>
                        </tr>

                        <tr>
                            <td
                                colspan="2"
                                style="text-align: left; font-weight: bold"
                            >
                                Total Keseluruhan
                            </td>
                            <td style="text-align: right">
                                <div
                                    style="
                                        display: flex;
                                        flex-direction: row;
                                        justify-content: flex-end;
                                        align-items: center;
                                    "
                                >
                                    <span>Rp.</span>
                                    <input
                                        type="text"
                                        matInput
                                        currencyMask
                                        formControlName="subtotal"
                                        style="width: 200px"
                                        [options]="{
                                            prefix: '',
                                            thousands: '.',
                                            precision: 0
                                        }"
                                    />
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td
                                colspan="2"
                                style="text-align: left; font-weight: bold"
                            >
                                Uang Muka
                            </td>
                            <td style="text-align: right">
                                <div
                                    style="
                                        display: flex;
                                        flex-direction: row;
                                        justify-content: flex-end;
                                        align-items: center;
                                    "
                                >
                                    <span>Rp.</span>
                                    <input
                                        type="text"
                                        matInput
                                        currencyMask
                                        formControlName="uangmuka"
                                        style="width: 200px"
                                        (keyup)="setsisapembayaran($event)"
                                        [options]="{
                                            prefix: '',
                                            thousands: '.',
                                            precision: 0
                                        }"
                                    />
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td
                                colspan="2"
                                style="text-align: left; font-weight: bold"
                            >
                                Voucher
                                <button
                                    mat-icon-button
                                    (click)="gotoModalVoc()"
                                >
                                    <mat-icon>error</mat-icon>
                                </button>
                            </td>
                            <td style="text-align: right">
                                <div
                                    style="
                                        display: flex;
                                        flex-direction: row;
                                        justify-content: flex-end;
                                        align-items: center;
                                    "
                                >
                                    <mat-chip-list
                                        class="example-chip"
                                        *ngIf="this.vouchertype.length > 0"
                                        formControlName="id_voucher"
                                    >
                                        <mat-chip
                                            class="example-box"
                                            *ngFor="let o of vouchertype"
                                            removable="true"
                                            (removed)="remove(o)"
                                        >
                                            {{ o.voucher_name }}
                                            <mat-icon matChipRemove
                                                >cancel</mat-icon
                                            >
                                        </mat-chip>
                                    </mat-chip-list>
                                    <!-- <span>{{this.vouchertype.length > 0 ? this.vouchertype[0].voucher_name : ''}}</span> -->
                                    <div style="width: 20px"></div>
                                    <span>{{
                                        this.contractForm.controls.voucher.value
                                            ? this.contractForm.controls.voucher.value.toLocaleString()
                                            : 0
                                    }}</span>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td
                                colspan="2"
                                style="text-align: left; font-weight: bold"
                            >
                                Sisa Pembayaran
                            </td>
                            <td style="text-align: right">
                                Rp.
                                {{
                                    this.contractForm.controls.sisapembayaran
                                        .value
                                        ? this.contractForm.controls.sisapembayaran.value.toLocaleString()
                                        : 0
                                }}
                            </td>
                        </tr>
                    </table>
                </div>
                <div
                    fxLayout="row"
                    fxLayoutAlign="center center"
                    style="padding: 30px"
                >
                    <button
                        mat-raised-button
                        color="primary"
                        (click)="savedata()"
                    >
                        Simpan dan Print Kontrak
                    </button>
                    <div style="width: 30px"></div>
                    <button
                        mat-raised-button
                        color="primary"
                        (click)="backback()"
                    >
                        Batal
                    </button>
                </div>
            </mat-card>
        </div>
    </form>
</div>
<ngx-spinner
    bdColor="rgba(255,255,255,1)"
    size="medium"
    color="#000"
    type="ball-clip-rotate-multiple"
    [fullScreen]="false"
></ngx-spinner>
